# UPS-D-240-24-Milandr
ПО ИБП-Д-240-24 для МК Миландр 

Версия ПО 1.3.00.<br>
Что нового:
1. Новый протокол передачи данных ИБП-Д <--> ПК. <br>
  1.1. Сформирован новый порядок регистров. Сначала регистры Read, потом Read/Write.<br>
  1.2. Добавлен новый регистр DEVICE_STATUS_2. Сигнализирующий о дополнительные события (см. протокол во вложении).<br>
  1.3. Добавлена таблица диапазонов и соотношений вводимых уставок напряжений.
2. (**`в процессе`**) Реализована приоритетность индикации. <br>
  2.1 (**`в процессе`**) Добавлена индикация о записи новых уставок (в процессе).
3. (**`в процессе`**) Введен временной интервал между проверками о наличии повышенного напряжения на нагрузке после фиксации этого события. Если на нагрузке зафиксировано напряжение превышающее максимум (U_LOAD > U_LOAD_MAX), то после переключения в режим Авария повторная проверка условия (U_LOAD > U_LOAD_MAX) производиться через 5 секунд (аналог проверки КЗ при питании нагрузки от батареи).<br>
4. (**`в процессе`**) Устранена проблема потери данных при вводе уставок с приложения под ПК. Проблема обусловлена ошибкой преобразования в тип float. Например, число 0.9 программой читается как 0.899999999<br>
5. (**`в процессе`**) Устранена проблема долгого выхода на режим   наблюдаемая при переходе из режима быстрой зарядки(Bulk) в режим перезаряда (Over) или уравнительного заряда (Equalizing) при не возможности достичь требуемого тока заряда из-за низкого уровня напряжения на КАН-Д. Невозможность достичь требуемого тока заряда приводит к тому, что величина ЦАП в итоге будет равна нулю. После перехода в режим Over или Equalizing, для поддержания требуемого уровня напряжения,  как правило, требуется значение ЦАП существенно больше 0. Но по существующему алгоритму выход на режим будет идти инкриментом ЦАП на 1, так как относительная разница между текущим и требуемым напряжением на батареи имеет такую величину, которая соответствует по текущему алгоритму инкрименту на 1.<br>
6. (**`в процессе`**) Обновлены данные в папке [Important Documents](https://github.com/kwsdevelopers/UPS-D-240-24-Milandr/tree/main/Important%20Documents)
7. Переименованы структуры RELE1_KAN_D, RELE2_BATTERY, RELE3_WARNING в RELE1_AC, RELE2_BATTERY, RELE3_STABLE_WORK, соответственно. С Целью соотвествия с наименованиями на лицевой панели ИБП-Д (наклейки).

